

var allFotosjson = [


  {
    "url1": "http://inphoto.pl/wp-content/uploads/2018/04/02_produktmodel.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2018/04/02_produktmodel-full.jpg",
    "category1": "SesjeModelem",
    "category2": "SesjeModelem",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/03-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/03-201901-REKLAMA-full.jpg",
    "category1": "SesjeModelem",
    "category2": "",
    "category3": "",
    "position": "poz50"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/01-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/01-201901-REKLAMA-full.jpg",
    "category1": "SesjeModelem",
    "category2": "SesjeModelem",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/21-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/21-201901-REKLAMA-full.jpg",
    "category1": "",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2018/04/03_jedzenia.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2018/04/03_jedzenie-full.jpg",
    "category1": "Jedzenie",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/02-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/02-201901-REKLAMA-full.jpg",
    "category1": "SesjeModelem",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/19-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/19-201901-REKLAMA-full.jpg",
    "category1": "Jedzenie",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/04-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/04-201901-REKLAMA-full.jpg",
    "category1": "SesjeModelem",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2018/04/07_jedzenie.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2018/04/07_jedzenie-full.jpg",
    "category1": "Jedzenie",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/05-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/05-201901-REKLAMA-full.jpg",
    "category1": "SesjeModelem",
    "category2": "Produkty",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2018/04/04_jedzenie-1.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2018/04/04_jedzenie-full.jpg",
    "category1": "Jedzenie",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/06-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/06-201901-REKLAMA-full.jpg",
    "category1": "SesjeModelem",
    "category2": "",
    "category3": "",
    "position": "poz20"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/07-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/07-201901-REKLAMA-full.jpg",
    "category1": "Produkty",
    "category2": "",
    "category3": "",
    "position": "poz70"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2018/04/13_produkt.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2018/04/13_produkt-full.jpg",
    "category1": "Produkty",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2018/04/14_modelprodukt.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2018/04/14_modelprodukt-full.jpg",
    "category1": "SesjeModelem",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2018/04/15_jedzenie.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2018/04/15_jedzenie-full.jpg",
    "category1": "Jedzenie",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2018/04/16_produktmodel-1.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2018/04/16_produktmodel-full.jpg",
    "category1": "SesjeModelem",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2018/04/17_produkt-1.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2018/04/17_produkt-full.jpg",
    "category1": "Produkty",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/52-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/52-201901-REKLAMA-full.jpg",
    "category1": "Produkty",
    "category2": "",
    "category3": "",
    "position": "poz50"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/08-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/08-201901-REKLAMA-full.jpg",
    "category1": "Produkty",
    "category2": "",
    "category3": "",
    "position": "poz70"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/10-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/10-201901-REKLAMA-full.jpg",
    "category1": "SesjeModelem",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/11-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/11-201901-REKLAMA-full.jpg",
    "category1": "SesjeModelem",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/12-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/12-201901-REKLAMA-full.jpg",
    "category1": "SesjeModelem",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/13-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/13-201901-REKLAMA-full.jpg",
    "category1": "SesjeModelem",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/14-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/14-201901-REKLAMA-full.jpg",
    "category1": "Produkty",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/15-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/15-201901-REKLAMA-full.jpg",
    "category1": "Produkty",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/16-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/16-201901-REKLAMA-full.jpg",
    "category1": "Produkty",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/17-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/17-201901-REKLAMA-full.jpg",
    "category1": "Jedzenie",
    "category2": "",
    "category3": "",
    "position": "poz50"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/22-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/22-201901-REKLAMA-full.jpg",
    "category1": "SesjeModelem",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/27-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/27-201901-REKLAMA-full.jpg",
    "category1": "SesjeModelem",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/31-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/31-201901-REKLAMA-full.jpg",
    "category1": "SesjeModelem",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/33-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/33-201901-REKLAMA-full.jpg",
    "category1": "SesjeModelem",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/36-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/36-201901-REKLAMA-full.jpg",
    "category1": "SesjeModelem",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },



  {
    "url1": "http://inphoto.pl/wp-content/uploads/2019/01/37-201901-REKLAMA.jpg",
    "url2": "http://inphoto.pl/wp-content/uploads/2019/01/37-201901-REKLAMA-full.jpg",
    "category1": "SesjeModelem",
    "category2": "",
    "category3": "",
    "position": "poz0"
  },

]



var gallery = document.querySelector('#Filtergallery');
// alert('gallery check');
if (gallery !== null) {
	// alert('gallery start');

//Variable declarations
	var FotoList = allFotosjson;
	// alert(FotoList);
	var FotosContainer = gallery.querySelector('.fotos');
	var i = 0;
	var viewmore = document.querySelector('#viewmore');
// Items on start
	var galleryCounter = 3;
// Items after download more
	var galleryLoader = 3;
	var activeItems = 0;
	var cat1 = '';
	var cat2 = '';
	var cat3 = '';
	var lightbox = document.querySelector('.LigthboxContent img');
	var lightboxCon = document.querySelector('.lighbox_container');
	var backdrop = document.querySelector('.backdrop');
	var activeLlightbox = null;
var loader = document.querySelector('#loader');

// alert('test9');
	// GALLERY LIGHTBOX //////////////////////////////////
	// Open lighbox function
		function openLighbox(i, url2){

			gallery_item.addEventListener('click', function(){
					// console.log('current id = '+i);
					activeLlightbox = i;
			lightbox.setAttribute('src', url2);
			backdrop.setAttribute("style", "visibility:visible;opacity:0.9");
			setTimeout(function(){lightboxCon.setAttribute("style", "transform:scale(1);");},1000);
			});
		}

	// Close lighbox function
function closeLightbox(){
	backdrop.removeAttribute("style", "visibility:visible;opacity:1");
	lightboxCon.removeAttribute("style", "transform:scale(1);");
	setTimeout(function() {lightbox.removeAttribute('src')}, 1000)

}
	var close = document.querySelector('.lighbox_container .close');
	var backdrop2 = document.querySelector('.backdrop2');
		close.addEventListener('click', function(){
closeLightbox();
		});
		backdrop2.addEventListener('click', function(){
		closeLightbox();
		});

// Prev lighbox function

function prevLightbox() {
  activeLlightbox--;
	if (activeLlightbox<0) {
		activeLlightbox=FotoList.length-1;
	}
	// console.log(activeLlightbox);
	url2=FotoList[activeLlightbox].url2;
  loader.setAttribute("style", "opacity:1!important");

  objImg = new Image();
  objImg.src = url2;
   objImg.onload = function() {
     lightbox.setAttribute('src', url2);
     setTimeout(function(){ loader.removeAttribute("style", "opacity:1!important"); }, 500);
    }
}

var prev = document.querySelector('.lightbox_cont_prev')
prev.addEventListener('click', function(){
prevLightbox();
  });


// Next lighbox function
function nextLightbox() {
  activeLlightbox++;
	if (activeLlightbox>FotoList.length-1) {
		activeLlightbox=0;
	}
	// console.log(activeLlightbox);
	url2=FotoList[activeLlightbox].url2;
     loader.setAttribute("style", "opacity:1!important");

	objImg = new Image();
	objImg.src = url2;
   objImg.onload = function() {
     lightbox.setAttribute('src', url2);

     setTimeout(function(){ loader.removeAttribute("style", "opacity:1!important"); }, 500);
	  }
}

var next = document.querySelector('.lightbox_next')
next.addEventListener('click', function(){
	nextLightbox();
});

console.log('454');
// KEYBOARD EVENT GALLERY

window.addEventListener('keydown', function (event) {
  // console.log('keydown');
var key = event.key || event.keyCode;
console.log(key);
if ( key === 'Escape' || key === 'Esc' || key === 27) {
	closeLightbox();
}

if ( key === 'ArrowLeft' || key === 37 || key === 'Left') {
  console.log('prev button');
  prevLightbox();
}

if ( key === 'ArrowRight' || key === 39 || key === 'Right') {
  console.log('next button');
  nextLightbox();
}

});




console.log('513');
// MOBILE EVENTS GALLERY

document.addEventListener('touchstart', handleTouchStart, false);
document.addEventListener('touchmove', handleTouchMove, false);

var xDown = null;
var yDown = null;

function handleTouchStart(evt) {
    xDown = evt.touches[0].clientX;
    yDown = evt.touches[0].clientY;
};

function handleTouchMove(evt) {
    if ( ! xDown || ! yDown ) {
        return;
    }

    var xUp = evt.touches[0].clientX;
    var yUp = evt.touches[0].clientY;

    var xDiff = xDown - xUp;
    var yDiff = yDown - yUp;

    if ( Math.abs( xDiff ) > Math.abs( yDiff ) ) {
        if ( xDiff > 0 ) {
          console.log('  /* left swipe */ ');
          prevLightbox();
        } else {
            console.log('/* right swipe */');
              nextLightbox();
        }
    }
    // else {
    //     if ( yDiff > 0 ) {
    //         // console.log('/* up swipe */ ');
    //         	closeLightbox();
    //     } else {
    //       // console.log('  /* down swipe */');
    //       	closeLightbox();
    //     }
    // }
    /* reset values */
    xDown = null;
    yDown = null;
};

console.log('test');

// reset filters
function resetGallery(){
	galleryCounter = 3;
	viewmore.classList.remove('hidden');
var filtersAll = gallery.querySelectorAll('.filter')
for (var i = 0; i < filtersAll.length; i++) {
	filtersAll[i].classList.remove('active');
}
FotosContainer.innerHTML="";
activeItems=0;
}


// add image functions
	function insertImage(i) {
		currentFoto = FotoList[i];
		cat1 = currentFoto.category1;
		cat2 = currentFoto.category2;
		cat3 = currentFoto.category3;
		url1 = currentFoto.url1;
		url2 = currentFoto.url2;
    position = currentFoto.position;
    // console.log(position);
		gallery_item = document.createElement("div");
		gallery_item.classList.add('item', 'gallery_item', 'fadein', position);
		gallery_item.style.backgroundImage = "url("+url1+")";
		gallery_item.setAttribute('categories', cat1+' '+cat2+' '+cat3 );
		FotosContainer.appendChild(gallery_item);
// console.log(url2);
openLighbox(i, url2)
	};

// alert('test10');
// Generate gallery
	function startGallery() {
		// console.log('start gallery fotos = '+fotos.length);
		// console.log('gallery counter= '+galleryCounter);

		for (var i = 0; i < galleryCounter; i++) {
			if ((FotoList[i]) != null) {
				insertImage(i);
				activeItems++;
			}
			else {
					 viewmore.classList.add('hidden');
			}
		};
		// console.log('active items= '+activeItems);
	};
	startGallery();

// Generate no filter gallery
var resetFilter = gallery.querySelector('.resetfilter')
resetFilter.addEventListener('click', function(){
resetGallery();
this.classList.add('active');
FotoList = allFotosjson;
startGallery();
});


// Generate start filter gallery
var filters = gallery.querySelectorAll('.triggerfilter');
// console.log(filters);
for (i = 0; i < filters.length; i++) {
	var filter = filters[i];
	filter.addEventListener('click', function(){

	var filtername = this.getAttribute('data-filtername');
	console.log('wybrany filter= '+filtername);
		resetGallery();
			this.classList.add('active');
		startFilterGalery(filtername)
	});
};


function startFilterGalery(filtername) {
		// console.log('gallery counter= '+galleryCounter);
		FotoList = [];
				for (var i = 0; i < allFotosjson.length; i++) {
					var currentFoto = allFotosjson[i];
					 cat1 = currentFoto.category1;
					 cat2 = currentFoto.category2;
					 cat3 = currentFoto.category3;
					if ((cat1 == filtername) || (cat2 == filtername) || (cat3 == filtername)) {
					FotoList.push(allFotosjson[i]);
					}
				}
				// console.log('Nowy obiekt fotolist:');
				// console.log(FotoList.length);
				// console.log(FotoList);
		for (var i = 0; i < FotoList.length; i++) {
			if ((FotoList[i] != null) && (activeItems < galleryCounter)) {
insertImage(i);
activeItems++;
			}
		}
		if (galleryCounter >= FotoList.length) {
			 // console.log('end gallery');
			viewmore.classList.add('hidden');
		}
};



// view more function
 function viewmorefn(){
	 for (var i = galleryCounter; i < galleryCounter+galleryLoader ; i++) {
	 if (FotoList[i] != null) {
		 insertImage(i);
		activeItems++;
	 }

	 }
	 galleryCounter= galleryCounter+galleryLoader;
		 // console.log('galleryCounter = '+galleryCounter);
	 // console.log(galleryCounter);
	 if (galleryCounter >= FotoList.length) {
		 // console.log('end gallery');
		 viewmore.classList.add('hidden');
	 }
 };
// Generate "view more" images

viewmore.addEventListener('click', function(){
	// console.log('add more from = '+galleryCounter);
if (galleryCounter < FotoList.length) {
viewmorefn();
}
});
}; // if gallery not null

//
